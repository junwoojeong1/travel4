<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>오사카 여행 — (날짜 탭 + 심플 구조)</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap" rel="stylesheet">
<!-- 사용자 업로드 웹폰트: 기본 경로는 /mnt/data/user-font.woff2 입니다. 실제 파일명이 다르면 교체해주세요. -->
<style>
@font-face{font-family: 'UserFont'; src: url('/mnt/data/user-font.woff2') format('woff2'), url('/mnt/data/user-font.woff') format('woff'); font-weight: 700; font-style: normal; font-display: swap;}
:root{
  --bg:#f6fbff; --accent:#0077c8; --accent-2:#00a4ff; --card:#fff; --muted:#6b7881; --text:#05212b; --radius:12px; --container:1100px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,'Noto Sans KR';font-size:16px}
.container{max-width:var(--container);margin:12px auto;padding:0 16px}
/* Hero */
.hero{background:linear-gradient(180deg, rgba(1,37,58,0.96), rgba(0,80,140,0.85)), url('https://images.unsplash.com/photo-1505765052422-6c1f2c3c27c4?auto=format&fit=crop&w=1400&q=80'); background-size:cover;border-radius:12px;padding:18px;color:#fff;display:flex;align-items:center;gap:12px}
.hero h1{font-size:1.7rem;margin:0;line-height:1.05}
.hero p{margin:6px 0 0 0;color:rgba(255,255,255,0.95)}
.title-font{font-family: 'UserFont', Inter, system-ui, -apple-system;}
/* Tabs */
.tabs{display:flex;gap:6px;overflow:auto;padding:10px 0;margin-top:12px}
.tab{background:transparent;border-radius:10px;padding:8px 12px;border:1px solid rgba(5,33,43,0.06);cursor:pointer;font-weight:700;white-space:nowrap}
.tab.active{background:linear-gradient(90deg,var(--accent-2),var(--accent));color:#012}
/* Layout simple */
.layout{display:flex;flex-direction:column;gap:12px;margin-top:12px}
.controls{display:flex;gap:8px;align-items:center}
.controls .search{flex:1}
.places{display:flex;flex-direction:column;gap:10px}
.card{background:var(--card);border-radius:12px;padding:12px;border:1px solid rgba(5,33,43,0.06);display:flex;justify-content:space-between;align-items:center;gap:12px}
.card .meta{display:flex;gap:12px;align-items:center}
.place-thumb{width:80px;height:60px;border-radius:8px;object-fit:cover}
.small{font-size:0.86rem;color:var(--muted)}
.fab{position:fixed;right:16px;bottom:78px;width:64px;height:64px;border-radius:999px;background:linear-gradient(90deg,var(--accent-2),var(--accent));display:flex;align-items:center;justify-content:center;color:#012;font-weight:900;box-shadow:0 10px 30px rgba(3,30,50,0.18);z-index:100}
.summary{display:flex;gap:12px;align-items:center}
.summary .pill{background:#fff;padding:8px 12px;border-radius:10px;border:1px solid rgba(5,33,43,0.06);font-weight:700}
/* Detail modal light-weight */
.modal{position:fixed;left:0;right:0;bottom:0;background:var(--card);border-top-left-radius:12px;border-top-right-radius:12px;padding:14px;border:1px solid rgba(5,33,43,0.06);box-shadow:0 -20px 40px rgba(3,30,50,0.08);transform:translateY(110%);transition:transform .28s ease-in-out;z-index:120}
.modal.open{transform:translateY(0%)}
.modal .row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
.input{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);}
.modal .actions{display:flex;gap:8px;justify-content:flex-end}
@media(max-width:430px){ .hero{padding:14px;border-radius:10px} .hero h1{font-size:1.4rem} .tab{padding:8px 10px;font-size:0.95rem} .card{padding:12px} }
</style>
</head>
<body>
  <main class="container">
    <section class="hero">
      <div>
        <h1 class="title-font">오사카 플래너 — 성인 준우의 첫 여행</h1>
        <p>간결한 날짜 탭 UI로 빠르게 날짜별 일정을 확인하세요. (상단 바 제거 · 구조 단순화)</p>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <div class="summary">
          <div class="pill" id="totalTimeDisplay">전체: 0분</div>
          <div class="pill" id="totalPriceDisplay">예상비: 0원</div>
        </div>
      </div>
    </section>

    <!-- Tabs: 전체 + Day 1..9 -->
    <div class="tabs" id="dayTabs" role="tablist" aria-label="날짜 탭"></div>

    <div class="layout">
      <div class="controls">
        <input id="globalSearch" class="search input" placeholder="검색 (이름/타입/라벨)" />
        <button id="searchBtn" class="tab">검색</button>
        <button id="exportBtn2" class="tab">내보내기</button>
        <button id="printBtn" class="tab">인쇄</button>
      </div>

      <div class="places" id="placesList"></div>
    </div>

    <!-- 간단한 하단 모달(편집) -->
    <div id="editModal" class="modal" aria-hidden="true">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong id="modalTitle">장소 편집</strong>
        <button id="closeModal">닫기</button>
      </div>
      <div class="row"><input id="m_name" class="input" placeholder="장소명"></div>
      <div class="row"><input id="m_type" class="input" placeholder="종류"></div>
      <div class="row"><input id="m_price" type="number" class="input" placeholder="예상 가격(원)"></div>
      <div class="row"><input id="m_stay" type="number" class="input" placeholder="체류시간(분)"></div>
      <div class="row"><input id="m_label" class="input" placeholder="라벨 (콤마로 구분)"></div>
      <div class="row"><input id="m_image" type="file" accept="image/*"></div>
      <div class="actions"><button id="saveModal" class="tab">저장</button><button id="deleteModal" class="tab">삭제</button></div>
    </div>

    <button id="mobileFab" class="fab">＋</button>
  </main>

<script>
// 간소화된 스크립트: 탭(전체/Day1..9), 심플 리스트, 모달 편집
const TOTAL_DAYS = 9;
let currentDay = 0; // 0 = 전체
let editingId = null;

function storageKey(d){ return 'osaka_day_' + d; }
for(let i=1;i<=TOTAL_DAYS;i++){ if(!localStorage.getItem(storageKey(i)) ) localStorage.setItem(storageKey(i), JSON.stringify({places:[]})); }
function loadDay(d){ try{ return JSON.parse(localStorage.getItem(storageKey(d))) || {places:[]} }catch(e){ return {places:[]} }}
function saveDay(data,d){ localStorage.setItem(storageKey(d), JSON.stringify(data)); }
function getAllPlaces(){ const out=[]; for(let d=1; d<=TOTAL_DAYS; d++){ (loadDay(d).places||[]).forEach(p=> out.push({...p, _day:d})); } return out; }
function newPlace(){ return { id: 'p_'+Date.now(), name:'무제 장소', type:'', price:0, stayTime:0, labels:[], image:'' }; }

// Tabs render
const dayTabs = document.getElementById('dayTabs');
function renderTabs(){ dayTabs.innerHTML=''; const addTab=(label, val)=>{ const b=document.createElement('button'); b.className='tab'; b.textContent=label; b.dataset.day=val; b.addEventListener('click', ()=> { currentDay = Number(val); render(); setActiveTab(); }); dayTabs.appendChild(b); };
  addTab('전체',0);
  for(let i=1;i<=TOTAL_DAYS;i++) addTab('Day '+i, i);
  setActiveTab(); }
function setActiveTab(){ Array.from(dayTabs.children).forEach(ch=>{ ch.classList.toggle('active', Number(ch.dataset.day) === currentDay); }); }

// List render
const placesList = document.getElementById('placesList');
function render(){ // totals
  const all = getAllPlaces(); const totalTime = all.reduce((s,p)=> s + (Number(p.stayTime)||0),0); const totalPrice = all.reduce((s,p)=> s + (Number(p.price)||0),0);
  document.getElementById('totalTimeDisplay').textContent = '전체: ' + (totalTime>0? (Math.floor(totalTime/60)+'h '+(totalTime%60)+'m') : '0분');
  document.getElementById('totalPriceDisplay').textContent = '예상비: ' + totalPrice + '원';

  let items = (currentDay===0) ? all : (loadDay(currentDay).places||[]).map(p=>({...p,_day:currentDay}));
  const q = (document.getElementById('globalSearch').value||'').trim().toLowerCase(); if(q) items = items.filter(p=> ((p.name||'')+' '+(p.type||'')+' '+(p.labels||[]).join(' ')).toLowerCase().includes(q));
  placesList.innerHTML='';
  if(items.length===0){ const emp=document.createElement('div'); emp.className='card'; emp.innerHTML='<div>장소가 없습니다. + 버튼으로 추가하세요.</div>'; placesList.appendChild(emp); return; }
  items.forEach(p=>{ const el=document.createElement('div'); el.className='card'; el.dataset.id=p.id; const left=document.createElement('div'); left.className='meta'; const img=document.createElement('img'); img.className='place-thumb'; img.src=p.image||'https://via.placeholder.com/160x120?text=No+Image'; left.appendChild(img); const txt=document.createElement('div'); txt.innerHTML='<div class="title-font" style="font-weight:800">'+(p.name||'무제 장소')+'</div><div class="small">'+(p.type||'종류 미지정')+' · Day '+(p._day||'?')+'</div>'; left.appendChild(txt);
    const right=document.createElement('div'); right.style.textAlign='right'; right.innerHTML='<div class="small">가격: '+(p.price||0)+'원</div><div class="small">체류: '+(p.stayTime||0)+'분</div>';
    const btn=document.createElement('button'); btn.textContent='편집'; btn.className='tab'; btn.style.marginTop='8px'; btn.addEventListener('click', ()=> openEdit(p)); right.appendChild(btn);
    el.appendChild(left); el.appendChild(right); placesList.appendChild(el); }); }

// Modal edit
const modal = document.getElementById('editModal'); const m_name = document.getElementById('m_name'); const m_type = document.getElementById('m_type'); const m_price = document.getElementById('m_price'); const m_stay = document.getElementById('m_stay'); const m_label = document.getElementById('m_label'); const m_image = document.getElementById('m_image');
function openEdit(p){ editingId = p.id; modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); document.getElementById('modalTitle').textContent = (p.name||'무제 장소'); m_name.value = p.name||''; m_type.value = p.type||''; m_price.value = p.price||0; m_stay.value = p.stayTime||0; m_label.value = (p.labels||[]).join(','); }
function closeEdit(){ editingId = null; modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); }
function saveEdit(){ const name=m_name.value.trim(); const type=m_type.value.trim(); const price=Number(m_price.value||0); const stay=Number(m_stay.value||0); const labels = m_label.value.split(',').map(s=>s.trim()).filter(Boolean);
  // find and save
  let found=false; for(let d=1; d<=TOTAL_DAYS; d++){ const day = loadDay(d); const idx = (day.places||[]).findIndex(x=>x.id===editingId); if(idx>-1){ day.places[idx] = {...day.places[idx], name, type, price, stayTime:stay, labels}; saveDay(day,d); found=true; break; } }
  if(!found){ // new (if editingId not in storage) -> add to currentDay
    const dayIndex = currentDay===0 ? 1 : currentDay; const day = loadDay(dayIndex); const p = newPlace(); p.id = editingId; p.name=name; p.type=type; p.price=price; p.stayTime=stay; p.labels=labels; day.places.push(p); saveDay(day, dayIndex); }
  closeEdit(); render(); }

function deleteEdit(){ if(!confirm('정말 삭제하시겠습니까?')) return; for(let d=1; d<=TOTAL_DAYS; d++){ const day = loadDay(d); const idx = (day.places||[]).findIndex(x=>x.id===editingId); if(idx>-1){ day.places.splice(idx,1); saveDay(day,d); break; } } closeEdit(); render(); }

// File image input handling (client-side read)
m_image.addEventListener && m_image.addEventListener('change', (ev)=>{ const f = ev.target.files[0]; if(!f || !editingId) return; const r=new FileReader(); r.onload = e => { // save image to the item
    for(let d=1; d<=TOTAL_DAYS; d++){ const day = loadDay(d); const idx = (day.places||[]).findIndex(x=>x.id===editingId); if(idx>-1){ day.places[idx].image = e.target.result; saveDay(day,d); break; } }
    render(); }; r.readAsDataURL(f); });

// add new place and open modal
const fab = document.getElementById('mobileFab'); fab.addEventListener('click', ()=>{ const dayIndex = currentDay===0?1:currentDay; const day = loadDay(dayIndex); const p = newPlace(); day.places.push(p); saveDay(day, dayIndex); render(); openEdit(p); });

// modal actions
document.getElementById('closeModal').addEventListener('click', closeEdit);
document.getElementById('saveModal').addEventListener('click', saveEdit);
document.getElementById('deleteModal').addEventListener('click', deleteEdit);

// export
document.getElementById('exportBtn2').addEventListener('click', ()=>{ const dump={}; for(let d=1; d<=TOTAL_DAYS; d++) dump['Day'+d] = loadDay(d); const blob=new Blob([JSON.stringify(dump,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='osaka_export.json'; a.click(); URL.revokeObjectURL(a.href); });

// print
document.getElementById('printBtn').addEventListener('click', ()=>{ const w=window.open('','_blank'); let html='<!doctype html><html><head><meta charset="utf-8"><title>Print</title></head><body>'; for(let d=1; d<=TOTAL_DAYS; d++){ const day=loadDay(d); if(!day.places || !day.places.length) continue; html += `<h2>Day ${d}</h2>`; day.places.forEach(p=>{ html += `<div><strong>${p.name}</strong> — ${p.type} — ${p.price}원 — ${p.stayTime}분</div>`; }); } html += '</body></html>'; w.document.write(html); w.document.close(); setTimeout(()=>w.print(),400); });

// search
document.getElementById('searchBtn').addEventListener('click', ()=> render());

// initial
renderTabs(); render();
</script>
</body>
</html>
